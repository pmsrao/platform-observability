{
  "version": "1.0",
  "type": "dashboard",
  "created": "2025-01-15",
  "author": "Platform Observability Team",
  "datasets": [
    {
      "name": "dataset_workspaces",
      "displayName": "Available Workspaces",
      "queryLines": [
        "SELECT 'ALL WORKSPACES' as workspace_name ",
        "UNION ALL ",
        "SELECT DISTINCT workspace_name ",
        "FROM platform_observability.plt_gold.gld_dim_workspace ",
        "WHERE workspace_name IS NOT NULL ",
        "ORDER BY workspace_name "
      ],
      "parameters": []
    },
    {
      "name": "dataset_001",
      "displayName": "Total Cost Summary",
      "queryLines": [
        "WITH cost_summary AS (",
        "  SELECT ",
        "    SUM(f.usage_cost) as total_cost_usd,",
        "    COUNT(DISTINCT f.workspace_key) as active_workspaces,",
        "    COUNT(DISTINCT f.entity_key) as active_entities,",
        "    AVG(f.usage_cost) as avg_daily_cost ",
        "  FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "  JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "  WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        ") ",
        "SELECT ",
        "  'Total Cost (30 days)' as metric,",
        "  CONCAT('$', FORMAT_NUMBER(total_cost_usd, 2)) as value,",
        "  'USD' as unit ",
        "FROM cost_summary ",
        "UNION ALL ",
        "SELECT ",
        "  'Active Workspaces' as metric,",
        "  CAST(active_workspaces AS STRING) as value,",
        "  'count' as unit ",
        "FROM cost_summary ",
        "UNION ALL ",
        "SELECT ",
        "  'Active Entities' as metric,",
        "  CAST(active_entities AS STRING) as value,",
        "  'count' as unit ",
        "FROM cost_summary ",
        "UNION ALL ",
        "SELECT ",
        "  'Avg Daily Cost' as metric,",
        "  CONCAT('$', FORMAT_NUMBER(avg_daily_cost, 2)) as value,",
        "  'USD/day' as unit ",
        "FROM cost_summary "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_002",
      "displayName": "Cost Trend",
      "queryLines": [
        "SELECT ",
        "  TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') AS usage_date,",
        "  SUM(f.usage_cost) as daily_cost_usd,",
        "  AVG(SUM(f.usage_cost)) OVER (ORDER BY f.date_key ROWS 6 PRECEDING) as rolling_7day_avg ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "GROUP BY usage_date ",
        "ORDER BY usage_date "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_003",
      "displayName": "Top Cost Centers",
      "queryLines": [
        "SELECT ",
        "  f.cost_center,",
        "  f.line_of_business,",
        "  SUM(f.usage_cost) as total_cost_usd,",
        "  COUNT(DISTINCT f.entity_key) as active_entities,",
        "  ROUND(try_divide(SUM(f.usage_cost), COUNT(DISTINCT f.entity_key)), 2) as cost_per_entity ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "  AND f.cost_center != 'unallocated' ",
        "GROUP BY f.cost_center, f.line_of_business ",
        "ORDER BY total_cost_usd DESC ",
        "LIMIT 10 "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_004",
      "displayName": "Runtime Health",
      "queryLines": [
        "WITH runtime_health AS (",
        "  SELECT ",
        "    c.dbr_version,",
        "    COUNT(DISTINCT c.cluster_key) as cluster_count,",
        "    SUM(f.usage_cost) as total_cost,",
        "    CASE ",
        "      WHEN (c.dbr_version LIKE '%16.%' OR c.dbr_version LIKE '%17.%') THEN 'Current' ",
        "      WHEN c.dbr_version LIKE '%15.%' THEN 'Recent' ",
        "      WHEN c.dbr_version LIKE '%14.%' THEN 'Older' ",
        "      ELSE 'Legacy' ",
        "    END as version_category ",
        "  FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "  JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "  JOIN platform_observability.plt_gold.gld_dim_cluster c ON f.cluster_key = c.cluster_key ",
        "  WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date ",
        "    AND c.is_current = true ",
        "    AND (:param_workspace IS NULL OR w.workspace_name IN (:param_workspace)) ",
        "  GROUP BY c.dbr_version, version_category ",
        ") ",
        "SELECT ",
        "  version_category,",
        "  COUNT(*) as runtime_versions,",
        "  SUM(cluster_count) as total_clusters,",
        "  SUM(total_cost) as total_cost_usd ",
        "FROM runtime_health ",
        "GROUP BY version_category ",
        "ORDER BY ",
        "  CASE version_category ",
        "    WHEN 'Current' THEN 1 ",
        "    WHEN 'Recent' THEN 2 ",
        "    WHEN 'Older' THEN 3 ",
        "    ELSE 4 ",
        "  END "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_005",
      "displayName": "Monthly Cost Breakdown",
      "queryLines": [
        "SELECT ",
        "  DATE_FORMAT(TO_DATE(CAST(date_key AS STRING), 'yyyyMMdd'), 'yyyy-MM') as month,",
        "  f.cost_center,",
        "  f.line_of_business,",
        "  SUM(f.usage_cost) as total_cost_usd,",
        "  COUNT(DISTINCT f.entity_key) as active_entities,",
        "  ROUND(try_divide(SUM(f.usage_cost), COUNT(DISTINCT f.entity_key)), 2) as cost_per_entity ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "WHERE cost_center != 'unallocated' ",
        "  AND TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date ",
        "GROUP BY DATE_FORMAT(TO_DATE(CAST(date_key AS STRING), 'yyyyMMdd'), 'yyyy-MM'), cost_center, line_of_business ",
        "ORDER BY month DESC, total_cost_usd DESC "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_006",
      "displayName": "Job Performance Analysis",
      "queryLines": [
        "SELECT ",
        "  e.name as job_name,",
        "  w.workspace_name,",
        "  COUNT(DISTINCT f.job_run_id) as total_runs,",
        "  SUM(f.usage_cost) as total_cost_usd,",
        "  ROUND(try_divide(SUM(f.usage_cost), COUNT(DISTINCT f.job_run_id)), 2) as cost_per_run ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "LEFT JOIN platform_observability.plt_gold.gld_dim_entity e ON f.entity_key = e.entity_key ",
        "LEFT JOIN platform_observability.plt_gold.gld_dim_cluster c ON f.cluster_key = c.cluster_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "  AND e.is_current = true ",
        "  AND e.entity_type IN ('JOB', 'PIPELINE') ",
        "GROUP BY e.name, w.workspace_name ",
        "HAVING COUNT(DISTINCT f.job_run_id) >= 3 ",
        "ORDER BY total_cost_usd DESC ",
        "LIMIT 15 "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_007",
      "displayName": "Filter Parameters",
      "queryLines": [
        "SELECT ",
        "  DISTINCT workspace_name ",
        "FROM platform_observability.plt_gold.gld_dim_workspace ",
        "WHERE status = 'RUNNING' ",
        "ORDER BY workspace_name "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_008",
      "displayName": "Cost Allocation by Business Unit",
      "queryLines": [
        "SELECT ",
        "  f.line_of_business,",
        "  f.cost_center,",
        "  f.department,",
        "  SUM(f.usage_cost) as total_cost_usd,",
        "  COUNT(DISTINCT f.entity_key) as active_entities,",
        "  COUNT(DISTINCT f.workspace_key) as active_workspaces,",
        "  ROUND(try_divide(SUM(f.usage_cost), COUNT(DISTINCT f.entity_key)), 2) as cost_per_entity ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date ",
        "  AND (:param_workspace IS NULL OR w.workspace_name IN (:param_workspace)) ",
        "GROUP BY f.line_of_business, f.cost_center, f.department ",
        "ORDER BY total_cost_usd DESC "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_009",
      "displayName": "Budget vs Actual Tracking",
      "queryLines": [
        "WITH monthly_costs AS (",
        "  SELECT ",
        "    DATE_FORMAT(TO_DATE(CAST(date_key AS STRING), 'yyyyMMdd'), 'yyyy-MM') as month,",
        "    SUM(usage_cost) as actual_cost,",
        "    LAG(SUM(usage_cost)) OVER (ORDER BY DATE_FORMAT(TO_DATE(CAST(date_key AS STRING), 'yyyyMMdd'), 'yyyy-MM')) as prev_month_cost ",
        "  FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "  JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "  WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "  GROUP BY DATE_FORMAT(TO_DATE(CAST(date_key AS STRING), 'yyyyMMdd'), 'yyyy-MM') ",
        ") ",
        "SELECT ",
        "  month,",
        "  actual_cost,",
        "  prev_month_cost,",
        "  ROUND(try_divide((actual_cost - prev_month_cost), prev_month_cost) * 100, 2) as month_over_month_change_pct ",
        "FROM monthly_costs ",
        "ORDER BY month DESC "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_010",
      "displayName": "Runtime Modernization Opportunities",
      "queryLines": [
        "WITH runtime_analysis AS (",
        "  SELECT ",
        "    c.cluster_id,",
        "    c.cluster_name,",
        "    c.dbr_version,",
        "    '' major_version,",
        "    '' minor_version,",
        "    0 runtime_age_months,",
        "    '' is_lts,",
        "    c.is_current,",
        "    CASE ",
        "      WHEN (c.dbr_version LIKE '%17.%' OR c.dbr_version LIKE '%16.%') THEN 'Current' ",
        "      WHEN c.dbr_version LIKE '%15.%' THEN 'Recent' ",
        "      WHEN c.dbr_version LIKE '%14.%' THEN 'Older' ",
        "      ELSE 'Legacy' ",
        "    END as version_category,",
        "    CASE ",
        "      WHEN c.dbr_version LIKE '%13.%' OR c.dbr_version LIKE '%12.%' THEN 'CRITICAL - End of Support' ",
        "      WHEN c.dbr_version LIKE '%14.%' THEN 'HIGH - Plan for Upgrade' ",
        "      WHEN (c.dbr_version LIKE '%17.%' OR c.dbr_version LIKE '%16.%' OR c.dbr_version LIKE '%15.%') THEN 'LOW - Current and Supported' ",
        "      ELSE 'MEDIUM - Need Review' ",
        "    END as upgrade_priority ",
        "  FROM platform_observability.plt_gold.gld_dim_cluster c ",
        "  WHERE c.is_current = true ",
        ") ",
        "SELECT ",
        "  upgrade_priority,",
        "  version_category,",
        "  COUNT(*) as cluster_count,",
        "  AVG(runtime_age_months) as avg_runtime_age,",
        "  STRING_AGG(DISTINCT dbr_version, ', ') as affected_runtimes ",
        "FROM runtime_analysis ",
        "GROUP BY upgrade_priority, version_category ",
        "ORDER BY ",
        "  CASE upgrade_priority ",
        "    WHEN 'CRITICAL - End of Support' THEN 1 ",
        "    WHEN 'HIGH - Plan for Upgrade' THEN 2 ",
        "    WHEN 'MEDIUM - Consider Upgrade' THEN 3 ",
        "    ELSE 4 ",
        "  END "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_011",
      "displayName": "Cluster Sizing Optimization",
      "queryLines": [
        "SELECT ",
        "  c.cluster_name,",
        "  c.worker_node_type_category,",
        "  c.min_autoscale_workers,",
        "  c.max_autoscale_workers,",
        "  SUM(f.usage_cost) as total_cost,",
        "  COUNT(DISTINCT f.job_run_id) as total_runs,",
        "  ROUND(try_divide(SUM(f.usage_cost), COUNT(DISTINCT f.job_run_id)), 2) as cost_per_run ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "JOIN platform_observability.plt_gold.gld_dim_cluster c ON f.cluster_key = c.cluster_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "  AND c.is_current = true ",
        "GROUP BY c.cluster_name, c.worker_node_type_category, c.min_autoscale_workers, c.max_autoscale_workers ",
        "HAVING COUNT(DISTINCT f.job_run_id) >= 1 ",
        "ORDER BY total_cost DESC ",
        "LIMIT 20 "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_012",
      "displayName": "Node Type Analysis",
      "queryLines": [
        "SELECT ",
        "  c.worker_node_type_category,",
        "  c.dbr_version,",
        "  SUM(f.usage_cost) as total_cost,",
        "  COUNT(DISTINCT f.job_run_id) as total_runs,",
        "  ROUND(try_divide(SUM(f.usage_cost), COUNT(DISTINCT f.job_run_id)), 2) as cost_per_run ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "JOIN platform_observability.plt_gold.gld_dim_cluster c ON f.cluster_key = c.cluster_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "  AND c.is_current = true ",
        "GROUP BY c.worker_node_type_category, c.dbr_version ",
        "ORDER BY total_cost DESC "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_013",
      "displayName": "Workflow Hierarchy Cost",
      "queryLines": [
        "SELECT ",
        "  workflow_level,",
        "  parent_workflow_name,",
        "  f.line_of_business,",
        "  f.cost_center,",
        "  COUNT(DISTINCT f.entity_key) as entity_count,",
        "  SUM(f.usage_cost) as total_cost_usd,",
        "  COUNT(DISTINCT f.workspace_key) as workspace_count,",
        "  ROUND(try_divide(SUM(f.usage_cost), COUNT(DISTINCT f.entity_key)), 2) as cost_per_entity ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "  AND workflow_level != 'STANDALONE' ",
        "GROUP BY workflow_level, parent_workflow_name, line_of_business, cost_center ",
        "ORDER BY total_cost_usd DESC "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_014",
      "displayName": "Tag Quality Analysis",
      "queryLines": [
        "WITH tag_coverage AS (",
        "  SELECT ",
        "    f.workspace_key,",
        "    COUNT(*) as total_records,",
        "    SUM(CASE WHEN f.cost_center != 'unallocated' THEN 1 ELSE 0 END) as cost_center_tagged,",
        "    SUM(CASE WHEN f.line_of_business != 'Unknown' THEN 1 ELSE 0 END) as lob_tagged,",
        "    SUM(CASE WHEN f.department IS NOT NULL AND f.department != '' THEN 1 ELSE 0 END) as dept_tagged ",
        "  FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "  JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "  WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "  GROUP BY f.workspace_key ",
        ") ",
        "SELECT ",
        "  w.workspace_name,",
        "  tc.total_records,",
        "  tc.cost_center_tagged,",
        "  tc.lob_tagged,",
        "  tc.dept_tagged,",
        "  ROUND(try_divide(tc.cost_center_tagged, tc.total_records) * 100, 2) as cost_center_coverage_pct,",
        "  ROUND(try_divide(tc.lob_tagged, tc.total_records) * 100, 2) as lob_coverage_pct,",
        "  ROUND(try_divide(tc.dept_tagged, tc.total_records) * 100, 2) as dept_coverage_pct ",
        "FROM tag_coverage tc ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON tc.workspace_key = w.workspace_key ",
        "ORDER BY cost_center_coverage_pct ASC "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_015",
      "displayName": "Usage Pattern Analysis",
      "queryLines": [
        "SELECT ",
        "  environment,",
        "  HOUR(usage_start_time) as hour_of_day,",
        "  COUNT(*) as usage_count,",
        "  SUM(usage_quantity) as total_usage,",
        "  AVG(usage_quantity) as avg_usage,",
        "  SUM(usage_cost) as total_cost ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "  AND usage_start_time IS NOT NULL ",
        "GROUP BY environment, HOUR(usage_start_time) ",
        "ORDER BY environment, hour_of_day "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_016",
      "displayName": "Business Unit Performance",
      "queryLines": [
        "SELECT ",
        "  f.line_of_business,",
        "  f.use_case,",
        "  COUNT(DISTINCT f.entity_key) as active_entities,",
        "  SUM(f.usage_cost) as total_cost_usd,",
        "  SUM(f.usage_quantity) as total_usage,",
        "  ROUND(try_divide(SUM(f.usage_cost), COUNT(DISTINCT f.entity_key)), 2) as cost_per_entity,",
        "  ROUND(try_divide(SUM(f.usage_cost), SUM(f.usage_quantity)), 4) as cost_per_unit ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date ",
        "  AND (:param_workspace IS NULL OR w.workspace_name IN (:param_workspace)) ",
        "GROUP BY f.line_of_business, f.use_case ",
        "ORDER BY total_cost_usd DESC "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_017",
      "displayName": "Project Cost Tracking",
      "queryLines": [
        "SELECT ",
        "  DATE_FORMAT(TO_DATE(CAST(date_key AS STRING), 'yyyyMMdd'), 'yyyy-MM') as month,",
        "  f.line_of_business,",
        "  department,",
        "  SUM(usage_cost) as project_cost_usd,",
        "  COUNT(DISTINCT f.entity_key) as active_entities,",
        "  COUNT(DISTINCT f.workspace_key) as active_workspaces ",
        "FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        "GROUP BY DATE_FORMAT(TO_DATE(CAST(date_key AS STRING), 'yyyyMMdd'), 'yyyy-MM'), line_of_business, department ",
        "ORDER BY month DESC, project_cost_usd DESC "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_018",
      "displayName": "Cost Center Analysis",
      "queryLines": [
        "WITH cost_summary AS (",
        "  SELECT ",
        "    f.cost_center,",
        "    f.line_of_business,",
        "    f.department,",
        "    DATE_FORMAT(TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd'), 'yyyy-MM') as month,",
        "    SUM(f.usage_cost) as monthly_cost,",
        "    COUNT(DISTINCT f.entity_key) as active_entities ",
        "  FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "  JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "  WHERE nvl(f.cost_center, 'unallocated') != 'unallocated' ",
        "    AND TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date ",
        "    AND (:param_workspace IS NULL OR w.workspace_name IN (:param_workspace)) ",
        "  GROUP BY f.cost_center, f.line_of_business, f.department, DATE_FORMAT(TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd'), 'yyyy-MM') ",
        ") ",
        "SELECT ",
        "  cost_summary.cost_center,",
        "  cost_summary.line_of_business,",
        "  cost_summary.department,",
        "  cost_summary.month,",
        "  cost_summary.monthly_cost,",
        "  cost_summary.active_entities,",
        "  ROUND(try_divide(cost_summary.monthly_cost, cost_summary.active_entities), 2) as cost_per_entity,",
        "  LAG(cost_summary.monthly_cost) OVER (PARTITION BY cost_summary.cost_center ORDER BY cost_summary.month) as prev_month_cost,",
        "  ROUND(try_divide((cost_summary.monthly_cost - LAG(cost_summary.monthly_cost) OVER (PARTITION BY cost_summary.cost_center ORDER BY cost_summary.month)), LAG(cost_summary.monthly_cost) OVER (PARTITION BY cost_summary.cost_center ORDER BY cost_summary.month)) * 100, 2) as cost_change_pct ",
        "FROM cost_summary ",
        "ORDER BY cost_summary.cost_center, cost_summary.month "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "dataset_019",
      "displayName": "KPI Metrics",
      "queryLines": [
        "WITH kpi_metrics AS (",
        "  SELECT ",
        "    SUM(f.usage_cost) as total_cost_usd,",
        "    COUNT(DISTINCT f.workspace_key) as active_workspaces,",
        "    COUNT(DISTINCT f.entity_key) as active_entities,",
        "    AVG(f.usage_cost) as avg_daily_cost ",
        "  FROM platform_observability.plt_gold.gld_fact_usage_priced_day f ",
        "  JOIN platform_observability.plt_gold.gld_dim_workspace w ON f.workspace_key = w.workspace_key ",
        "  WHERE TO_DATE(CAST(f.date_key AS STRING), 'yyyyMMdd') BETWEEN :param_start_date AND :param_end_date AND (:param_workspace IS NULL OR 'ALL WORKSPACES' IN (:param_workspace) OR w.workspace_name IN (:param_workspace))",
        ") ",
        "SELECT ",
        "  total_cost_usd,",
        "  active_workspaces,",
        "  active_entities,",
        "  avg_daily_cost ",
        "FROM kpi_metrics "
      ],
      "parameters": [
        {
          "displayName": "Start Date",
          "keyword": "param_start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-08-17T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "End Date",
          "keyword": "param_end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "2025-09-16T00:00:00.000"
                }
              ]
            }
          }
        },
        {
          "displayName": "Workspace",
          "keyword": "param_workspace",
          "dataType": "STRING",
          "allowMultiple": true,
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "<ALL WORKSPACES>"
                }
              ]
            }
          }
        }
      ]
    }
  ],
  "pages": [
    {
      "name": "overview-page-001",
      "displayName": "Overview",
      "layout": [
        {
          "widget": {
            "name": "overview_total_cost_summary",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_001",
                  "fields": [
                    {
                      "name": "metric",
                      "expression": "`metric`"
                    },
                    {
                      "name": "value",
                      "expression": "`value`"
                    },
                    {
                      "name": "unit",
                      "expression": "`unit`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "metric",
                    "displayName": "Metric",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "value",
                    "displayName": "Value",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "unit",
                    "displayName": "Unit",
                    "queryName": "main_query"
                  }
                ],
                "columns": [
                  {
                    "fieldName": "metric",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0
                  },
                  {
                    "fieldName": "value",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1
                  },
                  {
                    "fieldName": "unit",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Total Cost Summary"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 1,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "overview_cost_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_002",
                  "fields": [
                    {
                      "name": "date_key",
                      "expression": "`date_key`"
                    },
                    {
                      "name": "daily_cost_usd",
                      "expression": "`daily_cost_usd`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date_key",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  },
                  "displayName": "Date"
                },
                "y": {
                  "fieldName": "daily_cost_usd",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Daily Cost (USD)"
                  },
                  "displayName": "Daily Cost (USD)"
                },
                "fields": [
                  {
                    "fieldName": "date_key",
                    "displayName": "Date",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "daily_cost_usd",
                    "displayName": "Daily Cost (USD)",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "rolling_7day_avg",
                    "displayName": "7-Day Rolling Avg",
                    "queryName": "main_query"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Cost Trend (30 Days)"
              }
            }
          },
          "position": {
            "x": 6,
            "y": 1,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "overview_top_cost_centers",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_003",
                  "fields": [
                    {
                      "name": "cost_center",
                      "expression": "`cost_center`"
                    },
                    {
                      "name": "line_of_business",
                      "expression": "`line_of_business`"
                    },
                    {
                      "name": "total_cost_usd",
                      "expression": "`total_cost_usd`"
                    },
                    {
                      "name": "active_entities",
                      "expression": "`active_entities`"
                    },
                    {
                      "name": "cost_per_entity",
                      "expression": "`cost_per_entity`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "cost_center",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0
                  },
                  {
                    "fieldName": "line_of_business",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2
                  },
                  {
                    "fieldName": "active_entities",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3
                  },
                  {
                    "fieldName": "cost_per_entity",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 4
                  }
                ],
                "fields": [
                  {
                    "fieldName": "cost_center",
                    "displayName": "Cost Center",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "line_of_business",
                    "displayName": "Line of Business",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "displayName": "Total Cost (USD)",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "active_entities",
                    "displayName": "Active Entities",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_per_entity",
                    "displayName": "Cost per Entity",
                    "queryName": "main_query"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Top Cost Centers"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 12,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "global_start_date_filter",
            "queries": [
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_001_param_start_date",
                "query": {
                  "datasetName": "dataset_001",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_002_param_start_date",
                "query": {
                  "datasetName": "dataset_002",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_003_param_start_date",
                "query": {
                  "datasetName": "dataset_003",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_004_param_start_date",
                "query": {
                  "datasetName": "dataset_004",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_005_param_start_date",
                "query": {
                  "datasetName": "dataset_005",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_006_param_start_date",
                "query": {
                  "datasetName": "dataset_006",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_007_param_start_date",
                "query": {
                  "datasetName": "dataset_007",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_008_param_start_date",
                "query": {
                  "datasetName": "dataset_008",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_009_param_start_date",
                "query": {
                  "datasetName": "dataset_009",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_010_param_start_date",
                "query": {
                  "datasetName": "dataset_010",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_011_param_start_date",
                "query": {
                  "datasetName": "dataset_011",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_012_param_start_date",
                "query": {
                  "datasetName": "dataset_012",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_013_param_start_date",
                "query": {
                  "datasetName": "dataset_013",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_014_param_start_date",
                "query": {
                  "datasetName": "dataset_014",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_015_param_start_date",
                "query": {
                  "datasetName": "dataset_015",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_016_param_start_date",
                "query": {
                  "datasetName": "dataset_016",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_017_param_start_date",
                "query": {
                  "datasetName": "dataset_017",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_018_param_start_date",
                "query": {
                  "datasetName": "dataset_018",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_019_param_start_date",
                "query": {
                  "datasetName": "dataset_019",
                  "parameters": [
                    {
                      "name": "param_start_date",
                      "keyword": "param_start_date"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_001_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_002_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_003_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_004_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_005_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_006_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_007_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_008_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_009_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_010_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_011_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_012_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_013_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_014_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_015_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_016_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_017_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_018_param_start_date"
                  },
                  {
                    "parameterName": "param_start_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_019_param_start_date"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "DATE",
                    "values": [
                      {
                        "value": "2025-08-17T00:00:00.000"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Start Date"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 3,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "global_end_date_filter",
            "queries": [
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_001_param_end_date",
                "query": {
                  "datasetName": "dataset_001",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_002_param_end_date",
                "query": {
                  "datasetName": "dataset_002",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_003_param_end_date",
                "query": {
                  "datasetName": "dataset_003",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_004_param_end_date",
                "query": {
                  "datasetName": "dataset_004",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_005_param_end_date",
                "query": {
                  "datasetName": "dataset_005",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_006_param_end_date",
                "query": {
                  "datasetName": "dataset_006",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_007_param_end_date",
                "query": {
                  "datasetName": "dataset_007",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_008_param_end_date",
                "query": {
                  "datasetName": "dataset_008",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_009_param_end_date",
                "query": {
                  "datasetName": "dataset_009",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_010_param_end_date",
                "query": {
                  "datasetName": "dataset_010",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_011_param_end_date",
                "query": {
                  "datasetName": "dataset_011",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_012_param_end_date",
                "query": {
                  "datasetName": "dataset_012",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_013_param_end_date",
                "query": {
                  "datasetName": "dataset_013",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_014_param_end_date",
                "query": {
                  "datasetName": "dataset_014",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_015_param_end_date",
                "query": {
                  "datasetName": "dataset_015",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_016_param_end_date",
                "query": {
                  "datasetName": "dataset_016",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_017_param_end_date",
                "query": {
                  "datasetName": "dataset_017",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_018_param_end_date",
                "query": {
                  "datasetName": "dataset_018",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/dashboard_v1/datasets/dataset_019_param_end_date",
                "query": {
                  "datasetName": "dataset_019",
                  "parameters": [
                    {
                      "name": "param_end_date",
                      "keyword": "param_end_date"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_001_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_002_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_003_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_004_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_005_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_006_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_007_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_008_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_009_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_010_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_011_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_012_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_013_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_014_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_015_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_016_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_017_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_018_param_end_date"
                  },
                  {
                    "parameterName": "param_end_date",
                    "queryName": "parameter_dashboards/dashboard_v1/datasets/dataset_019_param_end_date"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "DATE",
                    "values": [
                      {
                        "value": "2025-09-16T00:00:00.000"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "End Date"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 0,
            "width": 3,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "global_workspace_filter",
            "queries": [
              {
                "name": "workspace_options",
                "query": {
                  "datasetName": "dataset_workspaces",
                  "parameters": [],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "param_workspace",
                    "queryName": "workspace_options",
                    "fieldName": "workspace_name"
                  }
                ]
              },
              "selection": {
                "defaultSelection": {
                  "values": {
                    "dataType": "STRING",
                    "values": [
                      {
                        "value": "ALL WORKSPACES"
                      }
                    ]
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace"
              }
            }
          },
          "position": {
            "x": 6,
            "y": 0,
            "width": 3,
            "height": 1
          }
        }
      ]
    },
    {
      "name": "finance-page-002",
      "displayName": "Finance",
      "layout": [
        {
          "widget": {
            "name": "finance_monthly_cost_breakdown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_005",
                  "fields": [
                    {
                      "name": "month",
                      "expression": "`month`"
                    },
                    {
                      "name": "cost_center",
                      "expression": "`cost_center`"
                    },
                    {
                      "name": "line_of_business",
                      "expression": "`line_of_business`"
                    },
                    {
                      "name": "total_cost_usd",
                      "expression": "`total_cost_usd`"
                    },
                    {
                      "name": "active_entities",
                      "expression": "`active_entities`"
                    },
                    {
                      "name": "cost_per_entity",
                      "expression": "`cost_per_entity`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "month",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0
                  },
                  {
                    "fieldName": "cost_center",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1
                  },
                  {
                    "fieldName": "line_of_business",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 2
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3
                  },
                  {
                    "fieldName": "active_entities",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 4
                  },
                  {
                    "fieldName": "cost_per_entity",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 5
                  }
                ],
                "fields": [
                  {
                    "fieldName": "month",
                    "displayName": "Month",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_center",
                    "displayName": "Cost Center",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "line_of_business",
                    "displayName": "Line of Business",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "displayName": "Total Cost (USD)",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "active_entities",
                    "displayName": "Active Entities",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_per_entity",
                    "displayName": "Cost per Entity",
                    "queryName": "main_query"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Monthly Cost Breakdown"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 12,
            "height": 8
          }
        }
      ]
    },
    {
      "name": "operations-page-003",
      "displayName": "Operations",
      "layout": [
        {
          "widget": {
            "name": "operations_runtime_health",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_004",
                  "fields": [
                    {
                      "name": "version_category",
                      "expression": "`version_category`"
                    },
                    {
                      "name": "runtime_versions",
                      "expression": "`runtime_versions`"
                    },
                    {
                      "name": "total_clusters",
                      "expression": "`total_clusters`"
                    },
                    {
                      "name": "total_cost_usd",
                      "expression": "`total_cost_usd`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "version_category",
                  "scale": {
                    "type": "ordinal"
                  },
                  "axis": {
                    "title": "Runtime Version Category"
                  },
                  "displayName": "Runtime Version Category"
                },
                "y": {
                  "fieldName": "total_clusters",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Number of Clusters"
                  },
                  "displayName": "Number of Clusters"
                },
                "fields": [
                  {
                    "fieldName": "version_category",
                    "displayName": "Version Category",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "runtime_versions",
                    "displayName": "Runtime Versions",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_clusters",
                    "displayName": "Total Clusters",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "displayName": "Total Cost (USD)",
                    "queryName": "main_query"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Runtime Health - Cluster Distribution"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "operations_job_performance",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_006",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "total_runs",
                      "expression": "`total_runs`"
                    },
                    {
                      "name": "total_cost_usd",
                      "expression": "`total_cost_usd`"
                    },
                    {
                      "name": "cost_per_run",
                      "expression": "`cost_per_run`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "job_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0
                  },
                  {
                    "fieldName": "workspace_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1
                  },
                  {
                    "fieldName": "total_runs",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2
                  },
                  {
                    "fieldName": "avg_duration_hours",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 4
                  },
                  {
                    "fieldName": "cost_per_run",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 5
                  }
                ],
                "fields": [
                  {
                    "fieldName": "job_name",
                    "displayName": "Job Name",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "workspace_name",
                    "displayName": "Workspace",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_runs",
                    "displayName": "Total Runs",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "displayName": "Total Cost (USD)",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_per_run",
                    "displayName": "Cost per Run",
                    "queryName": "main_query"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Job Performance Analysis"
              }
            }
          },
          "position": {
            "x": 6,
            "y": 0,
            "width": 6,
            "height": 8
          }
        }
      ]
    },
    {
      "name": "finance-cost-management-page",
      "displayName": "Finance & Cost Management",
      "layout": [
        {
          "widget": {
            "name": "cost_allocation_business_unit",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_008",
                  "fields": [
                    {
                      "name": "line_of_business",
                      "expression": "`line_of_business`"
                    },
                    {
                      "name": "cost_center",
                      "expression": "`cost_center`"
                    },
                    {
                      "name": "total_cost_usd",
                      "expression": "`total_cost_usd`"
                    },
                    {
                      "name": "active_entities",
                      "expression": "`active_entities`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "line_of_business",
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0
                  },
                  {
                    "fieldName": "cost_center",
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2
                  },
                  {
                    "fieldName": "active_entities",
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3
                  }
                ],
                "fields": [
                  {
                    "fieldName": "line_of_business",
                    "displayName": "Line of Business",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_center",
                    "displayName": "Cost Center",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "department",
                    "displayName": "Department",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "displayName": "Total Cost (USD)",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "active_entities",
                    "displayName": "Active Entities",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "active_workspaces",
                    "displayName": "Active Workspaces",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_per_entity",
                    "displayName": "Cost per Entity",
                    "queryName": "main_query"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Cost Allocation by Business Unit"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 12,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "platform-engineering-page",
      "displayName": "Platform Engineering",
      "layout": [
        {
          "widget": {
            "name": "runtime_modernization_opportunities",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_010",
                  "fields": [
                    {
                      "name": "upgrade_priority",
                      "expression": "`upgrade_priority`"
                    },
                    {
                      "name": "version_category",
                      "expression": "`version_category`"
                    },
                    {
                      "name": "cluster_count",
                      "expression": "`cluster_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "upgrade_priority",
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0
                  },
                  {
                    "fieldName": "version_category",
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1
                  },
                  {
                    "fieldName": "cluster_count",
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2
                  }
                ],
                "fields": [
                  {
                    "fieldName": "upgrade_priority",
                    "displayName": "Upgrade Priority",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "version_category",
                    "displayName": "Version Category",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cluster_count",
                    "displayName": "Cluster Count",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "avg_runtime_age",
                    "displayName": "Avg Runtime Age",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "affected_runtimes",
                    "displayName": "Affected Runtimes",
                    "queryName": "main_query"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Runtime Modernization Opportunities"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 12,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "data-quality-governance-page",
      "displayName": "Data Quality & Governance",
      "layout": [
        {
          "widget": {
            "name": "tag_quality_analysis",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_014",
                  "fields": [
                    {
                      "name": "workspace_name",
                      "expression": "`workspace_name`"
                    },
                    {
                      "name": "cost_center_coverage_pct",
                      "expression": "`cost_center_coverage_pct`"
                    },
                    {
                      "name": "lob_coverage_pct",
                      "expression": "`lob_coverage_pct`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "workspace_name",
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0
                  },
                  {
                    "fieldName": "cost_center_coverage_pct",
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 1
                  },
                  {
                    "fieldName": "lob_coverage_pct",
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2
                  }
                ],
                "fields": [
                  {
                    "fieldName": "workspace_name",
                    "displayName": "Workspace",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_records",
                    "displayName": "Total Records",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_center_tagged",
                    "displayName": "Cost Center Tagged",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "lob_tagged",
                    "displayName": "LOB Tagged",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "dept_tagged",
                    "displayName": "Dept Tagged",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_center_coverage_pct",
                    "displayName": "Cost Center Coverage %",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "lob_coverage_pct",
                    "displayName": "LOB Coverage %",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "dept_coverage_pct",
                    "displayName": "Dept Coverage %",
                    "queryName": "main_query"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Tag Quality Analysis"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 12,
            "height": 6
          }
        }
      ]
    },
    {
      "name": "business-intelligence-page",
      "displayName": "Business Intelligence",
      "layout": [
        {
          "widget": {
            "name": "business_unit_performance",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "dataset_016",
                  "fields": [
                    {
                      "name": "line_of_business",
                      "expression": "`line_of_business`"
                    },
                    {
                      "name": "use_case",
                      "expression": "`use_case`"
                    },
                    {
                      "name": "total_cost_usd",
                      "expression": "`total_cost_usd`"
                    },
                    {
                      "name": "active_entities",
                      "expression": "`active_entities`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "line_of_business",
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0
                  },
                  {
                    "fieldName": "use_case",
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 1
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "type": "decimal",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2
                  },
                  {
                    "fieldName": "active_entities",
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3
                  }
                ],
                "fields": [
                  {
                    "fieldName": "line_of_business",
                    "displayName": "Line of Business",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "use_case",
                    "displayName": "Use Case",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "active_entities",
                    "displayName": "Active Entities",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_cost_usd",
                    "displayName": "Total Cost (USD)",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "total_usage",
                    "displayName": "Total Usage",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_per_entity",
                    "displayName": "Cost per Entity",
                    "queryName": "main_query"
                  },
                  {
                    "fieldName": "cost_per_unit",
                    "displayName": "Cost per Unit",
                    "queryName": "main_query"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Business Unit Performance"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 12,
            "height": 6
          }
        }
      ]
    }
  ]
}